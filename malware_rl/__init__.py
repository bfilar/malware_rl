import numpy as np
from sklearn.model_selection import train_test_split
from gym.envs.registration import register
from malware_rl.envs.utils import interface


# create a holdout set
sha256 = interface.get_available_sha256()
sha256_train, sha256_holdout = train_test_split(sha256, test_size=20)

MAXTURNS = 5

register(
    id='malconv-train-v0',
    entry_point='malware_rl.envs:MalConvEnv',
    kwargs={'random_sample': True, 'maxturns': MAXTURNS, 'sha256list': sha256_train}
)

register(
    id='malconv-test-v0',
    entry_point='malware_rl.envs:MalConvEnv',
    kwargs={'random_sample': False, 'maxturns': MAXTURNS, 'sha256list': sha256_holdout}
)